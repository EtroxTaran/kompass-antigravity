---
description: MCP documentation tool usage - Ref, Context7, and Perplexity for API documentation lookup, version-specific docs, and web search
globs: []
alwaysApply: false
---

# MCP Documentation Tools

This rule covers documentation lookup tools: **Ref**, **Context7**, and **Perplexity**. Use these tools for retrieving API documentation, version-specific information, and current web-based knowledge.

**See also:** `.cursor/rules/mcp-tool-usage.mdc` for prioritization hierarchy and decision tree.

## Ref (ref.tools)

**What it's used for:**
API documentation and technical reference engine that retrieves official, structured documentation from various sources, including open source projects, APIs, and libraries.

**When to use:**
- User asks how to use a specific library, function, method, or API
- Need correct syntax, parameter descriptions, and usage examples
- Understanding how a third-party tool works before generating code
- Looking up TypeScript/JavaScript API references
- Checking NestJS decorators, React hooks, or framework methods

**When NOT to use:**
- Information already available in Graphiti memory
- Information already covered in project rules
- Need version-specific documentation (use Context7 instead)
- Need real-time web search results (use Perplexity instead)

**Prioritization:**
Use Ref BEFORE guessing about API syntax or library usage. It's your go-to for technical lookups before relying on memory or assumptions.

```typescript
// ✅ CORRECT: Use Ref to lookup API before generating code
// User asks: "How do I use NestJS @Query() decorator?"
// Step 1: Use Ref to search NestJS documentation
// Step 2: Generate code based on accurate documentation

// ❌ WRONG: Guessing API syntax without checking documentation
@Query() // Is this correct? Should it have parameters?
```

## Context7

**What it's used for:**
Documentation tool that provides real-time, version-specific, and source-linked documentation and examples from live repositories.

**When to use:**
- Need accurate information for libraries that change rapidly (open source or beta tools)
- Ref doesn't have the detail or version accuracy needed
- User mentions a specific package version
- Need precise documentation for bleeding-edge features
- Documentation accuracy is critical (security, API contracts)

**When NOT to use:**
- General API lookup (use Ref instead)
- Information available in standard documentation (use Ref)
- General knowledge questions (use Perplexity)
- Already found in Graphiti memory or project rules

**Prioritization:**
Use Context7 when precision matters or Ref lacks coverage. Particularly important for:
- Rapidly changing libraries (React 19, Next.js 15, etc.)
- Beta or experimental features
- Version-specific breaking changes

```typescript
// ✅ CORRECT: Use Context7 for version-specific documentation
// User asks: "How do I use React 19 useActionState hook?"
// Context7 provides React 19-specific documentation and examples

// ❌ WRONG: Using outdated React 18 examples when React 19 is specified
const [state, dispatch] = useReducer(...); // Wrong version
```

## Perplexity

**What it's used for:**
Powerful web search and reasoning tool that retrieves current, real-time information from the internet with sourced answers.

**When to use:**
- Answer general knowledge or fact-based questions not in context
- Resolve ambiguities about APIs, libraries, or concepts that may have changed recently
- Provide sourced answers or links to current documentation when Ref/Context7 don't suffice
- Research current best practices or industry standards
- Find up-to-date information about tools, frameworks, or technologies

**When NOT to use:**
- Information available in Graphiti memory (check first!)
- Information covered in project rules (check first!)
- API documentation lookup (use Ref/Context7)
- Code analysis (use Semgrep or codebase search)
- Testing web interfaces (use Playwright)

**Prioritization:**
Use Perplexity LAST in the documentation lookup chain, after checking memory, rules, Ref, and Context7. Use for current events, recent changes, or general knowledge.

```typescript
// ✅ CORRECT: Use Perplexity for current information
// User asks: "What's the latest best practice for JWT tokens in 2025?"
// Perplexity searches web for current best practices with sources

// ❌ WRONG: Using Perplexity when information is in project rules
// User asks: "What validation rules do we use for customer names?"
// Should check domain-model.mdc first, not search the web
```

## Documentation Tool Comparison

| Tool | Best For | When to Use |
|------|----------|-------------|
| **Ref** | Structured API documentation, standard library docs | General API/library lookup, syntax questions |
| **Context7** | Version-specific docs, bleeding-edge features | Specific versions mentioned, rapidly changing libs |
| **Perplexity** | Current best practices, general knowledge | After Ref/Context7, for recent changes or general facts |

## References

- Main MCP Tool Usage: `.cursor/rules/mcp-tool-usage.mdc`
- Graphiti Memory: `.cursor/rules/graphiti-memory.mdc`
- Project Rules: `.cursor/rules/*.mdc`
